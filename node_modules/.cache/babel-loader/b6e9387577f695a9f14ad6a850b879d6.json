{"ast":null,"code":"import _slicedToArray from \"/home/soulforger/Desktop/instagram-demo/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/soulforger/Desktop/instagram-demo/src/components/Story.js\";\nimport React, { useEffect, useRef, useState, useContext } from 'react';\nimport './story.scss';\nimport M from 'materialize-css/dist/js/materialize';\nimport firestore from '../firebase';\n\nconst Story = nani => {\n  const _useState = useState(false),\n        _useState2 = _slicedToArray(_useState, 2),\n        pause = _useState2[0],\n        setPause = _useState2[1];\n\n  const _useState3 = useState(0),\n        _useState4 = _slicedToArray(_useState3, 2),\n        widthstate = _useState4[0],\n        setWidthState = _useState4[1];\n\n  const _useState5 = useState({\n    img: [''],\n    pro: '',\n    name: ''\n  }),\n        _useState6 = _slicedToArray(_useState5, 2),\n        story_data = _useState6[0],\n        setStory_data = _useState6[1];\n\n  const _useState7 = useState(0),\n        _useState8 = _slicedToArray(_useState7, 2),\n        number = _useState8[0],\n        setNumber = _useState8[1];\n\n  var ID = nani.ID;\n  ID = ID.split(\"/\");\n  ID = ID[ID.length - 1];\n\n  const getStories = () => {\n    firestore.collection('stories').onSnapshot(shot => {\n      const allStories = [];\n      shot.forEach(cur => allStories.push(cur.data()));\n      setStory_data(allStories[ID]);\n    }, error => console.error(error));\n  };\n\n  const plus_image = index => {\n    if (index !== story_data.img.length) setNumber(number + 1);\n  };\n\n  const minus_image = index => {\n    if (index === 0 && ID === 0) console.log('hi');else setNumber(number - 1);\n  };\n\n  let _useState9 = useState(null),\n      _useState10 = _slicedToArray(_useState9, 2),\n      instance = _useState10[0],\n      setInstance = _useState10[1];\n\n  const carouselRef = useRef(null);\n  useEffect(() => {\n    setInstance(M.Carousel.init(carouselRef.current, {\n      fullWidth: true,\n      noWrap: true,\n      duration: 90\n    }));\n    return () => {// instance.destroy();\n    };\n  }, [story_data]);\n\n  if (story_data.img.length > 1) {\n    var slide = story_data.img.map((cur, i) => React.createElement(\"a\", {\n      className: \"carousel-item\",\n      key: i,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    }, React.createElement(\"img\", {\n      className: \"image\",\n      src: cur,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 55\n      },\n      __self: this\n    })));\n    slide = React.createElement(\"div\", {\n      ref: carouselRef,\n      className: \"carousel carousel-slider\",\n      onMouseDown: () => {\n        setPause(true);\n      },\n      onMouseUp: () => {\n        setPause(false);\n      },\n      onTouchStart: () => {\n        setPause(true);\n      },\n      ontouchEnd: () => {\n        setPause(false);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 57\n      },\n      __self: this\n    }, slide, React.createElement(\"a\", {\n      className: \"button btn arrow transparent\",\n      onClick: () => {\n        instance.prev();\n        minus_image(number);\n        setWidthState(0);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59\n      },\n      __self: this\n    }), React.createElement(\"a\", {\n      className: \"btn arrow transparent button_right\",\n      onClick: () => {\n        instance.next();\n        plus_image(number);\n        setWidthState(0);\n      },\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60\n      },\n      __self: this\n    }));\n  } else var slide = React.createElement(\"div\", {\n    style: {\n      height: \"87vh\"\n    },\n    onTouchStart: () => {\n      setPause(true);\n    },\n    ontouchEnd: () => {\n      setPause(false);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  }, React.createElement(\"a\", {\n    className: \"button_img btn arrow transparent\",\n    onClick: () => {\n      minus_image(number);\n      setWidthState(0);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 66\n    },\n    __self: this\n  }), React.createElement(\"a\", {\n    className: \"img\",\n    onMouseDown: () => {\n      setPause(true);\n    },\n    onMouseUp: () => {\n      setPause(false);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    className: \"image\",\n    src: story_data.img,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  })), React.createElement(\"a\", {\n    className: \"btn arrow transparent button_right_img\",\n    onClick: () => {\n      plus_image(number);\n      setWidthState(0);\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }));\n\n  const getComplete = i => {\n    if (number < 0) {\n      setNumber(0);\n      window.location = Number(ID) - 1;\n    }\n\n    if (number === story_data.img.length) {\n      instance.set(0);\n      setNumber(0);\n      window.location = Number(ID) + 1;\n    }\n\n    if (i == number) {\n      if (widthstate == 100) {\n        setNumber(number + 1);\n        setWidthState(0);\n        instance.next();\n      }\n\n      return widthstate;\n    }\n\n    if (i < number) return 100;\n    return 0;\n  };\n\n  useEffect(() => {\n    const load = () => {\n      if (pause === false) setWidthState(old => {\n        return Math.min(old + 1, 100);\n      });\n    };\n\n    const timer = setInterval(load, 100);\n    return () => {\n      clearInterval(timer);\n    };\n  });\n  const progress_loader = story_data.img.map((cur, i) => React.createElement(\"div\", {\n    className: \"progress\",\n    key: i,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"determinate\",\n    key: i,\n    id: \"loader\" + i,\n    style: {\n      width: getComplete(i) + '%'\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 115\n    },\n    __self: this\n  })));\n  useEffect(() => {\n    var elems = document.querySelectorAll('.modal');\n    var instances = M.Modal.init(elems, {\n      endingTop: '45%'\n    });\n  }, []);\n  useEffect(() => {\n    getStories();\n  }, []);\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"story_back row\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"story\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, React.createElement(\"ul\", {\n    className: \"collection with-header\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, React.createElement(\"li\", {\n    className: \"collection-item avatar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, React.createElement(\"img\", {\n    className: \"circle profile\",\n    src: story_data.pro,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }), React.createElement(\"div\", {\n    className: \"text\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138\n    },\n    __self: this\n  }, React.createElement(\"h6\", {\n    className: \"h5\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }, story_data.name), React.createElement(\"h6\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, \"1h\"), pause ? React.createElement(\"div\", {\n    className: \"btn paused\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  }, \"paused\") : React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142\n    },\n    __self: this\n  })), React.createElement(\"a\", {\n    \"data-target\": \"options\",\n    className: \"secondary-content modal-trigger\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, React.createElement(\"i\", {\n    className: \"material-icons white-text\",\n    style: {\n      fontSize: \"30px\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146\n    },\n    __self: this\n  }, \"more_horizs\")))), React.createElement(\"div\", {\n    className: \"progress_container\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149\n    },\n    __self: this\n  }, progress_loader), slide), React.createElement(\"div\", {\n    id: \"options\",\n    className: \"modal\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"modal-content\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"btn\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 156\n    },\n    __self: this\n  }, \"Report inappropriate\"), React.createElement(\"div\", {\n    className: \"btn\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, \"Cancel\")))));\n};\n\nexport default Story;","map":{"version":3,"sources":["/home/soulforger/Desktop/instagram-demo/src/components/Story.js"],"names":["React","useEffect","useRef","useState","useContext","M","firestore","Story","nani","pause","setPause","widthstate","setWidthState","img","pro","name","story_data","setStory_data","number","setNumber","ID","split","length","getStories","collection","onSnapshot","shot","allStories","forEach","cur","push","data","error","console","plus_image","index","minus_image","log","instance","setInstance","carouselRef","Carousel","init","current","fullWidth","noWrap","duration","slide","map","i","prev","next","height","getComplete","window","location","Number","set","load","old","Math","min","timer","setInterval","clearInterval","progress_loader","width","elems","document","querySelectorAll","instances","Modal","endingTop","fontSize"],"mappings":"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","sourcesContent":["import React, { useEffect, useRef, useState, useContext } from 'react';\nimport './story.scss'\nimport M from 'materialize-css/dist/js/materialize'\nimport firestore from '../firebase';\n\nconst Story = (nani) => {\n    const [pause, setPause] = useState(false);\n    const [widthstate, setWidthState] = useState(0);\n    const [story_data, setStory_data] = useState({\n        img : [''],\n        pro: '',\n        name: ''\n    });\n    const [number, setNumber] = useState(0);\n    var ID = nani.ID;\n    ID = ID.split(\"/\");\n    ID = ID[ID.length - 1];\n\n    const getStories = () => {\n        firestore.collection('stories').onSnapshot((shot) => {\n            const allStories = [];\n            shot.forEach((cur) => allStories.push(cur.data()));\n\n            setStory_data(allStories[ID]);\n        }, (error) => console.error(error))\n    }\n    const plus_image = (index) => {\n        if (index !== story_data.img.length)\n            setNumber(number + 1)\n    }\n    const minus_image = (index) => {\n        if (index === 0 && ID === 0)\n            console.log('hi')\n        else\n            setNumber(number - 1)\n    }\n\n    let [instance, setInstance] = useState(null);\n\n    const carouselRef = useRef(null);\n\n    useEffect(() => {\n        setInstance(M.Carousel.init(carouselRef.current, {\n            fullWidth: true,\n            noWrap: true,\n            duration: 90\n        }))\n\n        return () => {\n            // instance.destroy();\n        }\n    }, [story_data])\n\n    if (story_data.img.length > 1) {\n        var slide = story_data.img.map((cur, i) => (<a className=\"carousel-item\" key={i}><img className=\"image\" src={cur} /></a>))\n        slide = (\n            <div ref={carouselRef} className=\"carousel carousel-slider\" onMouseDown={() => { setPause(true); }} onMouseUp={() => { setPause(false); }} onTouchStart={() => { setPause(true) }} ontouchEnd={() => { setPause(false) }}>\n                {slide}\n                <a className=\"button btn arrow transparent\" onClick={() => { instance.prev(); minus_image(number); setWidthState(0) }}></a>\n                <a className=\"btn arrow transparent button_right\" onClick={() => { instance.next(); plus_image(number); setWidthState(0) }}></a>\n            </div>\n        )\n    } else\n        var slide = (\n            <div style={{ height: \"87vh\" }} onTouchStart={() => { setPause(true) }} ontouchEnd={() => { setPause(false) }}>\n                <a className=\"button_img btn arrow transparent\" onClick={() => { minus_image(number); setWidthState(0) }}></a>\n                <a className=\"img\" onMouseDown={() => { setPause(true); }} onMouseUp={() => { setPause(false); }}><img className=\"image\" src={story_data.img} /></a>\n                <a className=\"btn arrow transparent button_right_img\" onClick={() => { plus_image(number); setWidthState(0) }}></a>\n            </div>\n        )\n\n\n    const getComplete = (i) => {\n        if (number < 0) {\n            setNumber(0);\n            window.location = Number(ID) - 1;\n        }\n        if (number === story_data.img.length) {\n            instance.set(0);\n            setNumber(0);\n            window.location = Number(ID) + 1;\n        }\n        if (i == number) {\n            if (widthstate == 100) {\n                setNumber(number + 1);\n                setWidthState(0);\n                instance.next();\n            }\n            return widthstate;\n        }\n        if (i < number)\n            return 100;\n\n        return 0;\n    }\n\n\n    useEffect(() => {\n        const load = () => {\n            if (pause === false)\n                setWidthState((old) => {\n                    return Math.min(old + 1, 100)\n                })\n        }\n\n        const timer = setInterval(load, 100)\n\n        return () => {\n            clearInterval(timer);\n        }\n    })\n\n    const progress_loader = story_data.img.map((cur, i) => (\n        <div className=\"progress\" key={i}>\n            <div className=\"determinate\" key={i} id={\"loader\" + i} style={{ width: getComplete(i) + '%' }}></div>\n        </div>\n    ))\n\n    useEffect(() => {\n        var elems = document.querySelectorAll('.modal');\n        var instances = M.Modal.init(elems, {\n            endingTop: '45%'\n        });\n    }, [])\n\n\n    useEffect(() => {\n        getStories();\n    }, []);\n\n    return (\n        <div>\n            <div className='story_back row'>\n                <div className='story'>\n                    <ul className=\"collection with-header\">\n                        <li className=\"collection-item avatar\">\n                            <img className='circle profile' src={story_data.pro}></img>\n                            <div className=\"text\">\n                                <h6 className='h5'>{story_data.name}</h6>\n                                <h6>1h</h6>\n                                {\n                                    pause ? <div className=\"btn paused\">paused</div> : <div />\n                                }\n\n                            </div>\n                            <a data-target=\"options\" className=\"secondary-content modal-trigger\"><i className=\"material-icons white-text\" style={{ fontSize: \"30px\" }}>more_horizs</i></a>\n                        </li>\n                    </ul>\n                    <div className=\"progress_container\">\n                        {progress_loader}\n                    </div>\n                    {slide}\n                </div>\n                <div id=\"options\" className=\"modal\">\n                    <div className=\"modal-content\">\n                        <div className=\"btn\">\n                            Report inappropriate\n                    </div>\n                        <div className=\"btn\">\n                            Cancel\n                    </div>\n                    </div>\n                </div>\n            </div>\n        </div>\n    )\n}\n\nexport default Story;"]},"metadata":{},"sourceType":"module"}